apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    meta.helm.sh/release-name: infisical
    meta.helm.sh/release-namespace: xauth
  generation: 1
  name: test
  namespace: xauth
spec:
  backoffLimit: 10
  completionMode: NonIndexed
  completions: 1
  manualSelector: false
  parallelism: 1
  suspend: false
  template:
    metadata:
      creationTimestamp: null
      name: infisical-create-tables-test
    spec:
     restartPolicy: Never
     containers:
      - command: 
          - "sleep"
        args:
          - "8400"
        env:
        - name: DB_CONNECTION_URI
          value: postgresql://infisical:$(userpassword)@postgresql:5432/infisicalDB
        envFrom:
        - secretRef:
            name: infisical-secrets
        image: infisical/infisical:v0.46.3-postgres
        imagePullPolicy: IfNotPresent
        name: infisical-schema-migration
        resources: {}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File